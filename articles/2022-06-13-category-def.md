---
title: "圏の本質は合成だったんだ!?"
emoji: "🙌"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["圏論"]
published: false
---
# 圏の本質は合成...?
> しかし圏の本質は 合成 (composition) にある．
> 
> [1. 合成の本質｜プログラマのための圏論 (執筆中)](https://zenn.dev/taketo1024/books/850b20937af93b/viewer)

この言葉を，参考記事にある圏の具体例を使いつつ，自分なりに説明してみたいと思います．

* [はじめての圏論 その第1歩：しりとりの圏 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20060821/1156120185)
* [完全実装付きでもう一度お送りします，しりとりの圏 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20090424/1240552575)
* [はじめての圏論 その第2歩：行列の圏 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20060822/1156213781)
* [はじめての圏論 その第3歩：極端な圏達 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20060823/1156300345)

---

# ひらがなの文字列

参考記事
* [はじめての圏論 その第1歩：しりとりの圏 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20060821/1156120185)
* [完全実装付きでもう一度お送りします，しりとりの圏 - 檜山正幸のキマイラ飼育記 (はてなBlog)](https://m-hiyama.hatenablog.com/entry/20090424/1240552575)

`りんご`，`ご`，`ごりら`，`らっぱ`など，ひらがなの文字列がある．

このひらがなの文字列同士を**合成**するルールを決めよう．

## 例: 合成できる

例えば，次のように合成することができる．

* `りんご`と`ごりら`を合成すると，`りんごりら`になる．
* `ごりら`と`らっぱ`を合成すると，`ごりらっぱ`になる．

合成結果の`りんごりら`と`ごりらっぱ`も，`りんご`や`ごりら`と同じようにひらがなの文字列になった．
> `りんごりら`や`ごりらっぱ`という単語は存在しないが，ここで考えているのは**ひらがなの文字列**なので，問題ない．

## 例: 合成できない
次に，ひらがなの文字列が合成できない場合も考える．例えば，

* `りんご`と`らっぱ`は合成できない．

## ✅合成のルール　その1
では，合成できる場合と，できない場合の違いをどのように決めようか．
`りんご`の最後の文字は`'ご'`で，`ごりら`の最初の文字も`'ご'`であった．
これを二つのひらがなの文字列が合成できる条件にしよう．

:::message
✅合成のルール　その1
前の文字列の最後の文字と，後ろの文字列の最初の文字が同じとき，前後の文字列を合成した文字列を作ることができる．
:::

先ほどの例でいうと，
* `ごりら`と`らっぱ`が合成できたのは，`ごりら`の最後の文字と，`らっぱ`の最初の文字が，どちらも`'ら'`だったからだ．
* `りんご`と`らっぱ`が合成できなかったのは，`りんご`の最後の文字が`'ご'`であるのに対し，`らっぱ`の最初の文字は，`'ら'`だったからだ．

## 例: 三つの文字列を合成する
次に，`りんご`，`ごりら`，`らっぱ`の三つの文字列を合成してみよう．
合成は二つずつ行うので，どちらを先に合成するかで，二通りの方法が考えられる．

1. `りんご`と`ごりら`を合成して，`りんごりら`をつくる．
2. その後，`りんごりら`と`らっぱ`を合成して，`りんごりらっぱ`をつくる．

もう一つの方法は，
1. 先に，`ごりら`と`らっぱ`を合成して，`ごりらっぱ`をつくる．
2. そのあと，`りんご`と`ごりらっぱ`を合成して，`りんごりらっぱ`をつくる．

先にどちらを合成しても，`りんごりらっぱ`という同じひらがなの文字列になった．

## ✅合成のルール　その2

三つの文字列の合成では，どちらを先に合成しても，`りんごりらっぱ`という合成結果の文字列は変わらなかった．
この例から，合成のルールを追加しよう．

::: message
✅合成のルール　その2
三つの文字列を合成するとき，先にどちらを合成しても，結果は変わらない．
:::

## 例: 合成しても変わらない文字列がある

次に，`ご`というひらがなの文字列との合成を考える．

* `りんご`と`ご`を合成すると，`りんご`になる．
* `ご`と`ごりら`を合成すると，`ごりら`になる．

`ご`と合成しても，ひらがなの文字列(`りんご`，`ごりら`)は変わらなかった．

## ✅合成のルール　その3

ひらがなの文字列は，ひらがな一文字でできた文字列と合成しても，合成結果が元の文字列と変わらなかった．
これを合成のルールに追加する．

::: message
✅合成のルール　その3
合成結果の文字列を変えないような，ひらがな一文字の文字列が存在する．
:::

`ご`の他にも，`り`，`ら`，`ぱ`などがある．

## 💡圏論の言葉で表す
先ほどの例を圏論の言葉で表すことにしよう．

### 射 (ひらがなの文字列)
ひらがなの文字列は **射** と呼ばれるものだ．
`りんご`，`ご`，`ごりら`，`らっぱ`，`りんごりら`，`ごりらっぱ`，`りんごりらっぱ`，`り`，`ら`，`ぱ`は全て射である．

### 合成 (ひらがなの文字列の合成)
ひらがなの文字列の合成を **射の合成** という．射の合成には，ルールが必要だった．

> 合成のルール　その1
> 前の文字列の最後の文字と，後ろの文字列の最初の文字が同じとき，前後の文字列を合成した文字列を作ることができる．

ここで，圏論の言葉を使おう．
* ひらがなの文字列の最後の文字を **射のコドメイン(codomain)** と呼ぶ．
* ひらがなの文字列の最初の文字を **射のドメイン(domain)** と呼ぶ．

先ほどの文章を言い換えると，

::: message alert
✅合成のルール その1
ある射の**コドメイン**と，別の射の**ドメイン**が同じとき，合成した射を作ることができる．
:::

### 対象

* コドメインやドメインで表された，ひらがな一文字のことを **対象** と呼ぶ．
* 射のドメインとコドメインの対象を使って，**対象から対象への射**という．

今回の例だと，
* 射`りんご`のドメインは対象`'り'`で，コドメインは対象`'ご'`なので，`りんご`は`'り'`から`'ご'`への射である．
* 射`ご`のドメインは対象`'ご'`で，コドメインは対象`'ご'`なので，`ご`は`'ご'`から`'ご'`への射である．

### 合成射
* 合成した文字列のことを **合成射** と呼ぶ．

今回の例では，`りんご`と`ごりら`の合成射は`りんごりら`であり，`りんご`と`ご`の合成射は`りんご`である．

### 結合律 (三つの文字列を合成する順番は関係ない)
> 合成のルール　その2
> 三つの文字列を合成するとき，先にどちらを合成しても，結果は変わらない．

これを圏論の言葉で言い換えてみる．

::: message alert
✅合成のルール その2
三つの射を合成するとき，先にどちらを合成しても，結果は変わらない．
このことを，**結合律**と呼ぶ．
:::

今回の例では`りんご`と`ごりら`と`らっぱ`は合成の順番に関係なく`りんごりらっぱ`になった．

### 単位律 (合成結果を変えないようなひらがな一文字の文字列)
> 合成のルール　その3
> 合成結果の文字列を変えないような，ひらがな一文字の文字列が存在する．

これを圏論の言葉で言い換えてみる．

::: message alert
✅合成のルール その2
合成結果の文字列を変えないような，ひらがな一文字の文字列(**恒等射**)が存在する．
恒等射は各対象に一つずつ存在する．
このことを，**単位律**と呼ぶ．
:::

今回の例では，`り`，`ご`，`ら`，`ぱ`が恒等射である．

---

1. 射に対する合成のルールを決める．
`りんご` `ごりら` → `りんごりら`
`ごりら` `らっぱ` → `ごりらっぱ`
2. そのために，射のドメインとコドメインが必要になり，ここから射の対象が現れる．
`りんご`のドメインは`'り'`
`りんご`のコドメインは`'ご'`
`ごりら`のドメインは`'ご'`
`ごりら`のコドメインは`'ら'`
`らっぱ`のドメインは`'ら'`
`らっぱ`のコドメインは`'ぱ'`
したがって，対象は`'り'`，`'ご'`，`'ら'`，`'ぱ'`である．
3. 合成は結合律と，単位律を満たす必要があり，単位律から恒等射の存在が現れる．
(`りんご` `ごりら`) `らっぱ` → `りんごりら` `らっぱ` → `りんごりらっぱ`
`りんご` (`ごりら` `らっぱ`) → `りんご` `ごりらっぱ` → `りんごりらっぱ`

`りんご` `ご` → `りんご`
`ご` `ごりら` → `ごりら`

恒等射は`り`，`ご`，`ら`，`ぱ`

* 対象と射を集めて、合成のルールを決めたものを圏という．

対象は`'り'`，`'ご'`，`'ら'`，`'ぱ'`
射は`り`，`ご`，`ら`，`ぱ`，`りんご`，`ごりら`，`らっぱ`，`りんごりら`，`ごりらっぱ`，`りんごりらっぱ`

* 恒等射の存在によって，各対象に少なくとも一つは射が存在することになる．
* 恒等射を見れば，どんな対象が存在するのかわかる．

---

# 行列
## 例: 合成できる
## 例: 合成できない
## ✅合成のルール　その1
## 例: 合成してさらに合成する
## ✅合成のルール　その2
## 例: 合成しても変わらない
## ✅合成のルール　その3

行列の合成を考える．
ここでは，行列の乗算を合成ということにする．

ルール　その1

行列Aの列と行列Bの行が等しいとき，合成可能(乗算可能)であり，その結果は行列ABになる．

ルール　その2

行列A, B, Cに対して，合成の順番は関係ない．
つまり，(AB)C = A(BC) = ABCとなる．

ルール　その3

単位行列Iは，合成しても結果に影響を与えない．IA = A, AI = A

射は行列である．
射の合成は行列の乗算である．
射のコドメイン(列)とドメイン(行)を考えると，対象は自然数である．
恒等射は単位行列である．

# 関数

## 例: 合成できる
## 例: 合成できない
## ✅合成のルール　その1
## 例: 合成してさらに合成する
## ✅合成のルール　その2
## 例: 合成しても変わらない
## ✅合成のルール　その3

関数の合成を考える．

射は関数である．
射の合成は関数の合成である．
射のコドメイン(返値の型)とドメイン(引数の型)を考えると，対象は型である．
恒等射は引数をそのまま返す関数である．

# 整数

## 例: 合成できる
## 例: 合成できない
## ✅合成のルール　その1
## 例: 合成してさらに合成する
## ✅合成のルール　その2
## 例: 合成しても変わらない
## ✅合成のルール　その3

射は整数である．
射の合成は加算である．
射のコドメインとドメインは常に同じであり，対象は一つだけあれば何でもよい．
恒等射は0である．

射は a≦b である
射の合成は a≦b,b≦c を a≦c にする．
射のドメイン(≦の左の数字)と射のコドメイン(≦の右の数字)を考えると，対象は整数である．
恒等射は a≦a である．
